(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0daa181a"],{4553:function(t,e,a){"use strict";var i=a("aff5"),s=a.n(i);s.a},"91f6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[a("Form",{ref:"formValidate",attrs:{"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[a("Row",{attrs:{gutter:16,type:"flex"}},[a("Col",{staticStyle:{"line-height":"40px"},attrs:{xs:10,sm:12,md:16,lg:18}},[a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("名称")])]),a("Col",{attrs:{span:"17"}},[a("Input",{staticClass:"shinput",attrs:{placeholder:"请输入完整企业名称","element-id":"name",clearable:""},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("信用代码")])]),a("Col",{attrs:{span:"17"}},[a("Input",{staticClass:"shinput",attrs:{placeholder:"请输入","element-id":"id_card",clearable:""},model:{value:t.formValidate.credit_code,callback:function(e){t.$set(t.formValidate,"credit_code",e)},expression:"formValidate.credit_code"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("联络人")])]),a("Col",{attrs:{span:"17"}},[a("Input",{staticClass:"shinput",attrs:{placeholder:"请输入","element-id":"link_man",clearable:""},model:{value:t.formValidate.link_man,callback:function(e){t.$set(t.formValidate,"link_man",e)},expression:"formValidate.link_man"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("义乌街道")])]),a("Col",{attrs:{span:"17"}},[a("Select",{staticClass:"shinput",attrs:{placeholder:"义乌街道"},model:{value:t.formValidate.yw_street_id,callback:function(e){t.$set(t.formValidate,"yw_street_id",e)},expression:"formValidate.yw_street_id"}},t._l(t.yiwuStreetList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),[a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("企业类型")])]),a("Col",{attrs:{span:"17"}},[a("Select",{staticClass:"shinput",attrs:{placeholder:"企业类型"},model:{value:t.formValidate.classify_name,callback:function(e){t.$set(t.formValidate,"classify_name",e)},expression:"formValidate.classify_name"}},t._l(t.companyclassifyList,(function(e,i){return a("Option",{key:e.id,attrs:{value:e.classify_name}},[t._v(t._s(e.classify_name))])})),1)],1)],1),a("Col",{attrs:{xs:24,sm:12,md:8,lg:6}},[a("Col",{staticClass:"shtitle",attrs:{span:"5"}},[a("span",{staticClass:"shtitle"},[t._v("联络人手机号")])]),a("Col",{attrs:{span:"17"}},[a("Input",{staticClass:"shinput",attrs:{placeholder:"请输入","element-id":"link_phone",clearable:""},model:{value:t.formValidate.link_phone,callback:function(e){t.$set(t.formValidate,"link_phone",e)},expression:"formValidate.link_phone"}})],1)],1),a("Col",{staticClass:"ivu-text-right userFrom",attrs:{xs:14,sm:12,md:8,lg:6}},[a("Button",{staticClass:"mr15",attrs:{type:"primary",icon:"ios-search",label:"default"},on:{click:t.Searchs}},[t._v("搜索")]),a("Button",{staticClass:"ResetSearch",on:{click:function(e){return t.reset("leave")}}},[t._v("重置")])],1)]],2)],1)],1),a("Form",[a("Row",{staticClass:"mt20",attrs:{type:"flex"}},[a("Button",{staticClass:"bnt mr15",attrs:{type:"success",loading:t.button_loading},on:{click:t.exports}},[t._v(t._s(t.downloadstr)+"\n        ")]),a("Button",{staticClass:"mr20",attrs:{type:"primary"},on:{click:t.setcompanyClassify}},[t._v("批量设置企业类型")])],1)],1),a("Table",{ref:"table",staticClass:"mt25",attrs:{columns:t.columns1,data:t.list,"no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果",loading:t.loading,"highlight-row":""},on:{"on-selection-change":t.onSelectTab,"on-sort-change":t.sortChanged,"on-select-all":t.selectAll,"on-select-all-cancel":t.selectAll,"on-select-cancel":t.selectAll},scopedSlots:t._u([{key:"image",fn:function(e){var i=e.row;e.index;return[i.company_qrcode?a("viewer",[a("div",{staticClass:"tabBox_img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.company_qrcode,expression:"row.company_qrcode"}]})])]):t._e()]}},{key:"action",fn:function(e){var i=e.row,s=e.index;return[a("Button",{attrs:{size:"small"},on:{click:function(e){return t.edit(i)}}},[t._v("查看人员转移联络员")]),a("Button",{attrs:{size:"small"},on:{click:function(e){return t.deleteSmping(i,"删除"+i.name+"企业信息",s)}}},[t._v("删除企业")])]}},{key:"travel_img",fn:function(t){var e=t.row;t.index;return[a("viewer",[a("div",{staticClass:"tabBox_img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.travel_img,expression:"row.travel_img"}]})])])]}},{key:"guanzhu",fn:function(e){var i=e.row;return[a("Button",{on:{click:function(e){return t.issubscribe(i.id)}}},[t._v("关注企业")])]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,current:t.formValidate.page,"show-elevator":"","show-total":"","show-sizer":"","page-size-opts":[5,10,15,20],"page-size":t.formValidate.size},on:{"on-page-size-change":t.sizeChange,"on-change":t.pageChange}})],1)],1),a("Modal",{attrs:{title:t.edittitle,width:"550","class-name":"vertical-center-modal"},model:{value:t.editmodal,callback:function(e){t.editmodal=e},expression:"editmodal"}},[a("Form",{ref:"editformValidate",attrs:{model:t.editformValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"企业名称",prop:"name"}},[a("Input",{staticStyle:{width:"380px"},attrs:{disabled:"",placeholder:"企业名称"},model:{value:t.editformValidate.name,callback:function(e){t.$set(t.editformValidate,"name",e)},expression:"editformValidate.name"}})],1),a("FormItem",{attrs:{label:"联络人",prop:"link_name"}},[a("Input",{staticStyle:{width:"380px"},attrs:{disabled:"",placeholder:"联络人"},model:{value:t.editformValidate.link_name,callback:function(e){t.$set(t.editformValidate,"link_name",e)},expression:"editformValidate.link_name"}})],1),a("FormItem",{attrs:{label:"企业类型",prop:"classify_name"}},[a("Select",{staticStyle:{width:"380px"},attrs:{placeholder:"企业类型"},model:{value:t.editformValidate.classify_name,callback:function(e){t.$set(t.editformValidate,"classify_name",e)},expression:"editformValidate.classify_name"}},t._l(t.companyclassifyList,(function(e,i){return a("Option",{key:e.id,attrs:{value:e.classify_name}},[t._v(t._s(e.classify_name))])})),1)],1),a("FormItem",{attrs:{label:"所属街道",prop:"yw_street"}},[a("Input",{staticStyle:{width:"380px"},attrs:{disabled:"",placeholder:"所属街道"},model:{value:t.editformValidate.yw_street,callback:function(e){t.$set(t.editformValidate,"yw_street",e)},expression:"editformValidate.yw_street"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("editformValidate")}}},[t._v("提交")])],1)],1),a("Modal",{attrs:{title:"员工信息",draggable:"",width:"900px"},model:{value:t.dialogvisable,callback:function(e){t.dialogvisable=e},expression:"dialogvisable"}},[a("div",{staticStyle:{display:"flex"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.FormValue.user_name,expression:"FormValue.user_name"}],attrs:{type:"text",placeholder:"请输入员工姓名"},domProps:{value:t.FormValue.user_name},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchperson()},input:function(e){e.target.composing||t.$set(t.FormValue,"user_name",e.target.value)}}}),t._v(" \n      "),a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.searchperson()}}},[t._v("查询员工")])],1),a("Table",{attrs:{columns:t.columns2,data:t.dialogdata,height:"600px"},scopedSlots:t._u([{key:"index",fn:function(e){var i=e.index;return[a("span",[t._v(" "+t._s(i+1)+" ")])]}},{key:"action",fn:function(e){var i=e.row;e.index;return[i.user_name!==t.linkPersonInfo.link_name||i.user_phone!==t.linkPersonInfo.link_phone?a("a",{on:{click:function(e){return t.updateperson(i)}}},[t._v("设置为联络员")]):t._e()]}}])}),a("Page",{attrs:{total:t.total_1,current:t.pages},on:{"on-change":t.changepages}})],1),a("Modal",{attrs:{title:"设置企业类型",width:"450",closable:"",scrollable:"","footer-hide":"","mask-closable":!1},model:{value:t.showcompanyClassify,callback:function(e){t.showcompanyClassify=e},expression:"showcompanyClassify"}},[a("Form",{ref:"formcompanyClassify",attrs:{model:t.formcompanyClassify,"label-width":90,"label-position":t.labelPosition2},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"企业类型",prop:"check_frequency"}},[a("Select",{staticClass:"shinput",staticStyle:{width:"200px"},attrs:{placeholder:"企业类型"},model:{value:t.formcompanyClassify.classify_id,callback:function(e){t.$set(t.formcompanyClassify,"classify_id",e)},expression:"formcompanyClassify.classify_id"}},t._l(t.companyclassifyList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.classify_name))])})),1)],1),a("Button",{staticStyle:{width:"100px","margin-left":"50%",transform:"translate(-50%, 0)"},attrs:{type:"primary",long:""},on:{click:function(e){return t.handleSubmit("formcompanyClassify")}}},[t._v("提交")])],1)],1)],1)},s=[],n=a("a34a"),o=a.n(n),l=a("2f62"),r=a("8593"),c=a("4328"),d=a.n(c),m=a("fcac"),u=(a("2e83"),a("5f87")),f=a("3f2a"),p=a("d00d"),h=a("6112");function y(t,e,a,i,s,n,o){try{var l=t[n](o),r=l.value}catch(c){return void a(c)}l.done?e(r):Promise.resolve(r).then(i,s)}function g(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var n=t.apply(e,a);function o(t){y(n,i,s,o,l,"next",t)}function l(t){y(n,i,s,o,l,"throw",t)}o(void 0)}))}}function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(a,!0).forEach((function(e){b(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function b(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var k={components:{template:h["a"]},name:"company_list",mixins:[p["a"]],data:function(){var t=this;return{FormValue:{user_name:""},linkPersonInfo:"",addsubscribe:!0,ruleValidate:{classify_name:[{required:!0,message:"必填",trigger:"blur"}]},formcompanyClassify:{company_ids:",",classify_id:""},edittitle:"编辑企业类型",editmodal:!1,editformValidate:{},companyid:"",dialogvisable:!1,columns2:[{title:"序号",slot:"index",minWidth:50},{title:"企业名称",key:"company_name",minWidth:150},{title:"所属街道",key:"yw_street",minWidth:120},{title:"员工姓名",key:"user_name",minWidth:80},{title:"员工手机号",key:"user_phone",minWidth:100},{title:"员工身份证号",key:"user_idcard",minWidth:150},{title:"核酸检测时间",key:"hsjc_time",minWidth:150},{title:"操作",slot:"action",minWidth:90}],dialogdata:[],pages:1,company_id:0,companyclassifyList:[],collapse:!1,token:"Bearer "+Object(u["a"])(),modal1:!1,fileurlL:"/adminapi/file/tmp/upload?token="+Object(u["a"])(),grid:{xl:7,lg:7,md:12,sm:24,xs:24},total:0,total_1:0,loading:!1,roleData:{status1:""},dataList:[],formSelection:[],selectionList:[],selectionCopy:[],checkBox:!1,array_ids:[],user_ids:"",formValidate:{page:1,size:10},list:[],columns1:[{width:60,align:"center",renderHeader:function(e,a){return e("div",{class:{"select-panel":!0},on:{mouseenter:function(e){t.display="block"},mouseleave:function(e){t.display="none"}}},[e("Checkbox",{props:{value:t.checkBox},on:{"on-change":function(e){t.checkBox=e,t.$refs.table.selectAll(t.checkBox),t.isAll=e?0:-1}}})])},render:function(e,a){return e("Checkbox",{props:{value:a.row.checkBox},on:{"on-change":function(e){e?t.formSelection.push(a.row):(t.checkBox=!1,t.formSelection.forEach((function(e,i){e.id===a.row.id&&t.formSelection.splice(i,1)}))),t.ids=t.formSelection.map((function(t){return t.id})),a.row.checkBox=e,t.list[a.index].checkBox=e}},ref:"checkbox",refInFor:!0})}},{title:"序号",key:"order",width:50},{title:"统一社会信用代码",key:"credit_code",width:120},{title:"企业名称",key:"name",width:120},{title:"联络人",key:"link_name",width:50},{title:"联络人手机号",key:"link_phone",width:90},{title:"企业类型",key:"classify_name",width:100},{title:"所属街道",key:"yw_street",width:80},{title:"社区",key:"community",width:80},{title:"地址",key:"addr",width:130},{title:"员工数",key:"user_count",width:70,sortable:!0},{title:"2天内检测率",key:"two_rate",width:50},{title:"7天内检测率",key:"seven_rate",width:50},{title:"70天内检测率",key:"seventy_rate",width:50},{title:"二维码",slot:"image",width:100},{title:"操作",slot:"action",width:150},{title:"关注",slot:"guanzhu",width:100}],FromData:null,modalTitleSs:"",ids:Number,srcList:[],excelDatamodals:!1,excelData:!0,select_name:"",downloadProgress:0,button_loading:!1,downloadstr:"批量下载",showcompanyClassify:!1}},computed:v({},Object(l["e"])("admin/layout",["isMobile"]),{labelWidth:function(){return this.isMobile?void 0:50},labelPosition:function(){return this.isMobile?"top":"left"}}),created:function(){this.getSmpling(),this.getcompanyClassify()},methods:{handleSubmit:function(t){var e=this;if("formcompanyClassify"==t){var a={company_ids:",",classify_id:this.formcompanyClassify.classify_id};this.formSelection.forEach((function(t){a.company_ids=a.company_ids+t.id+","})),Object(m["e"])(a).then((function(t){var a=t.data;200==a.code?(e.$Message.success(a.msg),e.getSmpling(),e.showcompanyClassify=!1):e.$Message.error(a.msg)}))}},setcompanyClassify:function(){var t=this.formSelection;t.length?this.showcompanyClassify=!0:this.$Message.error("请先选择操作的数据")},onSelectTab:function(t){this.selectionList=t;var e=[];this.selectionList.map((function(t){e.push(t.uid)})),this.array_ids=e,this.user_ids=e.join(",")},selectAll:function(t){var e=this;t.length?(this.formSelection=t,this.selectionCopy=t):this.formSelection=[],this.selectionCopy.forEach((function(t,a){t.checkBox=e.checkBox,e.$set(e.list,a,t)}))},sortChanged:function(t){this.formValidate[t.key]=t.order,this.getSmpling()},getcompanyClassify:function(){var t=this;Object(m["b"])().then((function(e){t.companyclassifyList=e.data.data}))},exports:function(){this.getExportsApi()},getExportsApi:function(){var t=g(o.a.mark((function t(){var e,a,i,s;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.button_loading=!0,[],[],[],"",e=Object.assign({},this.formValidate),delete e.size,delete e.page,delete e.end_date,delete e.start_date,a=JSON.parse(JSON.stringify(e)),t.next=10,this.getExcelData(a);case 10:if(i=t.sent,400!=i.code){t.next=15;break}return this.$Message.error(i.msg),this.button_loading=!1,t.abrupt("return");case 15:return s=i.data.path,this.send_count=0,this.getCsvProgress(s),t.abrupt("return");case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getCsvProgress:function(t){var e=this;Object(f["s"])({path:t}).then((function(a){var i=a.data;if(100==i.data.progress)e.button_loading=!1,e.downloadstr="批量下载",window.open(t+"?"+Date.now());else{e.downloadProgress=i.data.progress,e.downloadstr=e.downloadProgress+"%";var s=e;setTimeout((function(){s.getCsvProgress(t)}),1e3)}}))},excelishas:function(t){var e=this;if(20==this.send_count)return this.button_loading=!1,void this.$Message.error("请求失败");Object(r["G"])(t).then((function(a){if(console.log(t,"str"),200==a.data.code)e.button_loading=!1,window.open(t+"?"+Date.now());else{console.log(a.data.msg,"失败");var i=e;setTimeout((function(){i.excelishas(t),i.send_count++}),1e3)}}))},getExcelData:function(t){return new Promise((function(e,a){console.log(t),Object(f["b"])(t).then((function(t){return e(t.data)}))}))},reset:function(t){this.formValidate={keyword:"",page:1,size:20},this.getSmpling()},exportfuntion:function(){return console.log(this.token),"http://localhost:8080/adminapi/export/sampleOrgan?"+d.a.stringify(this.formValidate)},onCancel:function(){},ok:function(){},cancel:function(){},handleSuccess:function(t,e,a){var i=this,s={path:t.data.src};sampleOrganVerify(s).then((function(t){console.log(t.data.data,"resData"),i.excelDatamodals=!0,i.excelData=t.data.data,i.getSmpling()}))},openItImage:function(t,e){this.srcList=[],this.srcList=t,this.select_name=e,this.modal1=!0},getSmpling:function(){var t=this;this.loading=!0,this.formSelection=[],this.selectionList=[],this.selectionCopy=[],this.checkBox=!1,Object(m["c"])(this.formValidate).then((function(e){t.loading=!1,console.log(e.data),t.list=e.data.data.data,t.total=e.data.data.total,t.list.map((function(e,a){e.order=(t.formValidate.page-1)*t.formValidate.size+a+1,e.checkBox=!1}))}))},sizeChange:function(t){this.formValidate.size=t,this.getSmpling(),this.$refs.table.clearCurrentRow()},pageChange:function(t){this.formValidate.page=t,this.getSmpling()},editt:function(t){this.editformValidate=t,this.roleid=t.id,this.edittitle="编辑企业类型分类",this.editmodal=!0},edit:function(t){var e=this;this.dialogvisable=!0,this.company_id=t.id,console.log(t);var a={company_id:t.id,page:1};this.companyid=t.id,Object(m["d"])(a).then((function(t){console.log(t.data.data),e.dialogdata=t.data.data.data,e.linkPersonInfo=t.data.data.link,e.total_1=t.data.data.total,e.pages=1}))},deleteSmping:function(t,e,a){var i=this,s={title:e,num:a,url:"company/".concat(t.id),method:"DELETE",ids:""};this.$modalSure(s).then((function(t){console.log(t),200==t.data.code?(i.$Message.success(t.data.msg),i.list.splice(a,1),i.getSmpling()):i.$Message.error(t.data.msg)})).catch((function(t){i.$Message.error(t.data.msg)}))},Searchs:function(){this.formValidate.page=1,this.getSmpling()},updateperson:function(t){var e=this,a={staff_id:t.id,company_id:t.company_id};Object(m["q"])(a).then((function(t){console.log(t,"111111"),200==t.data.code&&e.$Message.info("设置成功")}))},searchperson:function(){var t=this,e={company_id:this.company_id,page:1,user_name:this.FormValue.user_name};Object(m["d"])(e).then((function(e){console.log(e.data.data),t.dialogdata=e.data.data.data,t.total_1=e.data.data.total,t.pages=1}))},changepages:function(t){var e=this,a={page:t,company_id:this.companyid};console.log(t,"1111"),Object(m["d"])(a).then((function(t){console.log(t.data.data),e.dialogdata=t.data.data.data,e.total_1=t.data.data.total,e.pages=t.data.data.page}))},issubscribe:function(t){var e=this;Object(m["n"])({company_id:t}).then((function(t){if(200==t.status)return e.$Message.success("关注成功")}))}}},w=k,x=(a("987f"),a("4553"),a("2877")),C=Object(x["a"])(w,i,s,!1,null,"3e2f8a96",null);e["default"]=C.exports},"987f":function(t,e,a){"use strict";var i=a("a26f"),s=a.n(i);s.a},a26f:function(t,e,a){},aff5:function(t,e,a){}}]);